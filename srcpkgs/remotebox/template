# Template file for 'remotebox'
pkgname=remotebox
version=2.7
revision=1
archs="x86_64"
wrksrc="RemoteBox-${version}"
depends="gtk+ perl perl-SOAP-Lite perl-LWP perl-Gtk2"
short_desc="FOSS Client for vboxsrv"
maintainer="MGlolenstine <mglolenstine@gmail.com>"
license="GPL-2.0-only"
homepage="https://remotebox.knobgoblin.org.uk/"
distfiles="http://remotebox.knobgoblin.org.uk/downloads/RemoteBox-${version}.tar.bz2"
checksum=eb96631dc55cc5718f973308047e88b91884e9bf1f7ca2e25204e37bda334e33

do_install() {
	local package_location="usr/lib/$pkgname-$version" item
	vinstall "packagers-readme/remotebox.ico" 644 /usr/share/pixmap/ remotebox.ico
	vmkdir "${package_location}/share"
	vcopy "remotebox" "${package_location}"
	vcopy "share/*" "${package_location}/share"
	vcopy "docs" "${package_location}/share"
	vmkdir usr/bin
	ln -sfr $DESTDIR/${package_location}/remotebox $DESTDIR/usr/bin/remotebox
	vmkdir usr/share/
	vmkdir usr/share/applications
	vcopy "packagers-readme/remotebox.desktop" "usr/share/applications/remotebox.desktop"
	sed -i -e "s|^\(use lib \"\).*\(\";\)$|\1/usr/lib/remotebox-${version}/share/remotebox\2|" $DESTDIR/${package_location}/remotebox || die
	sed -i -e "s|^\(our \$sharedir = \"\).*\(\";\)$|\1/usr/lib/remotebox-${version}/share/remotebox\2|" $DESTDIR/${package_location}/remotebox || die
	sed -i -e "s|^\(our \$docdir\)  \( = \"\).*\(\";\)$|\1\2/usr/lib/remotebox-${version}/share/docs\3|" $DESTDIR/${package_location}/remotebox || die

	# Cleanup comments
	sed -i -e "/^# \^\^\^.*$/d" remotebox || die
	sed -i -e "/^# \*\*\*.*$/d" remotebox || die
}
